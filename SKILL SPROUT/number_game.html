<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Number Spell Game</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2&display=swap" rel="stylesheet" />
<style>
  body {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    background-image: url('num.jpg');
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;
    background-attachment: fixed;
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #intro, #game-container, #end-screen {
    background: rgba(255,255,255,0.85);
    border-radius: 16px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
    width: 550px;
    padding: 60px 50px;
    text-align: center;
    position: absolute;
  }
  #intro {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  #intro h1 {
    font-size: 58px;
    color: #237de4;
    margin-bottom: 40px;
  }
  #start-btn {
    background: #237de4;
    border: none;
    color: white;
    padding: 20px 60px;
    font-size: 28px;
    border-radius: 16px;
    cursor: pointer;
  }
  #start-btn:hover {
    background: #1a5fc4;
  }
  #game-container, #end-screen {
    display: none;
    flex-direction: column;
    align-items: center;
  }

  .number-display {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    font-size: 120px;
    font-weight: bold;
    color: #237de4;
    margin-bottom: 10px;
  }
  .number-spelling {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    font-size: 70px;
    color: #237de4;
    margin-bottom: 30px;
    font-weight: 600;
  }
  #answer {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    font-size: 32px;
    padding: 14px;
    width: 300px;
    border-radius: 12px;
    border: 2px solid #26b2be;
    text-align: center;
    outline: none;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
    margin-bottom: 15px;
  }
  #answer:focus {
    border-color: #1f96b1;
    box-shadow: 0 0 8px #447ae7;
  }
  #answer::placeholder {
    color: #777;
    font-style: italic;
  }
  #feedback {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    font-size: 24px;
    font-weight: 600;
    height: 40px;
    color: #2f7cc0;
    margin-top: 15px;
    min-height: 32px;
    min-width: 320px;
  }
  #scorecard, #scorecard-end {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    font-size: 24px;
    margin-top: 30px;
    color: #2f7cc0;
  }
  #restart-btn, #quit-btn, #end-restart-btn, #end-quit-btn {
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    font-size: 28px;
    padding: 14px 40px;
    border-radius: 12px;
    border: none;
    color: white;
    cursor: pointer;
    margin: 20px 10px 0 10px;
  }
  #quit-btn, #end-quit-btn {
    background: #d32f2f;
  }
  #quit-btn:hover, #end-quit-btn:hover {
    background: #b71c1c;
  }
  #end-screen h1 {
    font-size: 50px;
    color: #237de4;
    margin-bottom: 40px;
  }
  #end-restart-btn {
    background: #237de4;
  }
  #end-restart-btn:hover {
    background: #1a5fc4;
  }
  .great-job {
    font-size: 36px !important;
    font-weight: 700;
  }
</style>
</head>
<body>

<div id="intro" aria-label="Intro screen">
  <h1>Number Spell Game!</h1>
  <button id="start-btn" type="button" aria-label="Start the game">Start</button>
</div>

<div id="game-container" role="main" aria-live="polite" aria-label="Number learning game">
  <div class="number-display" id="number-display">0</div>
  <div class="number-spelling" id="number-spelling">zero</div>

  <input id="answer" type="text" maxlength="30" aria-describedby="feedback" aria-label="Type the spelling of the number" placeholder="Spell here..." autocomplete="off" />

  <div id="feedback" role="alert" aria-live="assertive"></div>

  <div id="scorecard" aria-live="polite">
    Correct: <span id="score-correct">0</span> | Wrong: <span id="score-wrong">0</span>
  </div>

  <button id="quit-btn" type="button" aria-label="Quit the game">Quit</button>
</div>

<div id="end-screen" aria-label="End screen">
  <h1>Well done! You rock!</h1>
  <div id="scorecard-end" aria-live="polite" style="margin-bottom: 20px;">
    Correct: <span id="end-score-correct">0</span> | Wrong: <span id="end-score-wrong">0</span>
  </div>
  <button id="end-restart-btn" type="button" aria-label="Restart the game">Restart</button>
  <button id="end-quit-btn" type="button" aria-label="Quit the game">Quit</button>
</div>

<script>
  const maxAttempts = 3;
  let currentNumber = 0;
  let attemptCount = 0;
  let correctCount = 0;
  let wrongCount = 0;
  let speaking = false;

  const intro = document.getElementById('intro');
  const startBtn = document.getElementById('start-btn');
  const gameContainer = document.getElementById('game-container');
  const endScreen = document.getElementById('end-screen');
  const endRestartBtn = document.getElementById('end-restart-btn');
  const endQuitBtn = document.getElementById('end-quit-btn');
  const numberDisplay = document.getElementById('number-display');
  const numberSpelling = document.getElementById('number-spelling');
  const answerInput = document.getElementById('answer');
  const feedback = document.getElementById('feedback');
  const scoreCorrect = document.getElementById('score-correct');
  const scoreWrong = document.getElementById('score-wrong');
  const quitBtn = document.getElementById('quit-btn');
  const endScoreCorrect = document.getElementById('end-score-correct');
  const endScoreWrong = document.getElementById('end-score-wrong');

  function speak(text, callback) {
    if ('speechSynthesis' in window && !speaking) {
      speaking = true;
      // window.speechSynthesis.cancel();

      const utterance = new SpeechSynthesisUtterance(text);
      utterance.rate = 0.7; // slower speed
      utterance.pitch = 1.2;
      utterance.lang = 'en-US';

      utterance.onend = () => {
        speaking = false;
        if (callback) callback();
      };

      utterance.onerror = () => {
        speaking = false;
        if (callback) callback();
      };

      window.speechSynthesis.speak(utterance);
    } else if (callback) {
      callback();
    }
  }

  function numberToWords(n) {
    const ones = ["zero","one","two","three","four","five","six","seven","eight","nine","ten",
      "eleven","twelve","thirteen","fourteen","fifteen"];
    if (n < 16) return ones[n];
    return "";
  }

  function normalize(str) {
    return str.trim().toLowerCase().replace(/[-\s]+/g, '');
  }

  function updateScorecard() {
    scoreCorrect.textContent = correctCount;
    scoreWrong.textContent = wrongCount;
  }

  function showIntro() {
    intro.style.display = 'flex';
    gameContainer.style.display = 'none';
    endScreen.style.display = 'none';
  }

  function startGame() {
    intro.style.display = 'none';
    gameContainer.style.display = 'flex';
    endScreen.style.display = 'none';
    currentNumber = 0;
    correctCount = 0;
    wrongCount = 0;
    updateScorecard();
    loadNumber();
  }

  function showEndScreen() {
    intro.style.display = 'none';
    gameContainer.style.display = 'none';
    endScreen.style.display = 'flex';
    endScoreCorrect.textContent = correctCount;
    endScoreWrong.textContent = wrongCount;
  }

  function loadNumber() {
    if(currentNumber > 15) {
      showEndScreen();
      return;
    }
    attemptCount = 0;
    numberDisplay.textContent = currentNumber;
    numberSpelling.textContent = numberToWords(currentNumber);
    answerInput.value = '';
    answerInput.disabled = false;
    answerInput.focus();
    feedback.textContent = '';
    feedback.classList.remove('great-job');
    updateScorecard();
    speak(currentNumber.toString());
  }

  function checkAnswer() {
    if(answerInput.value.trim() === '') return;
    const correctAnswer = numberToWords(currentNumber);
    if(normalize(answerInput.value) === normalize(correctAnswer)) {
      feedback.classList.add('great-job');
      feedback.textContent = 'Great job!';
      speak('Correct!', () => {
        correctCount++;
        currentNumber++;
        loadNumber();
      });
    } else {
      feedback.classList.remove('great-job');
      attemptCount++;
      if(attemptCount < maxAttempts) {
        feedback.classList.add('great-job');
        feedback.textContent = 'Try again!';
        speak('Try again!', () => {});
        answerInput.value = '';
        answerInput.focus();
      } else {
        feedback.classList.remove('great-job');
        feedback.textContent = `Incorrect. The correct answer is "${correctAnswer}".`;
        speak(`The correct answer is ${correctAnswer.replace(/-/g,' ')}`, () => {
          wrongCount++;
          currentNumber++;
          loadNumber();
        });
      }
    }
    updateScorecard();
  }

  startBtn.addEventListener('click', startGame);
  quitBtn.addEventListener('click', () => {
    answerInput.disabled = true;
    feedback.textContent = `Game quit. Score: ${correctCount} correct, ${wrongCount} wrong.`;
    quitBtn.style.display = 'none';
    showEndScreen();
  });
  endRestartBtn.addEventListener('click', startGame);
  endQuitBtn.addEventListener('click', () => {
    window.close();
    alert('Thank you for playing!');
  });

  answerInput.addEventListener('keydown', function(event){
    if(event.key === 'Enter'){
      event.preventDefault();
      checkAnswer();
    }
  });

  showIntro();
</script>
</body>
</html>
